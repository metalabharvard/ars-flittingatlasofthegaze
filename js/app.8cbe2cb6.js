!function(t){function e(e){for(var a,o,c=e[0],l=e[1],s=e[2],u=0,p=[];u<c.length;u++)o=c[u],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&p.push(r[o][0]),r[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);for(d&&d(e);p.length;)p.shift()();return i.push.apply(i,s||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],a=!0,c=1;c<n.length;c++){var l=n[c];0!==r[l]&&(a=!1)}a&&(i.splice(e--,1),t=o(o.s=n[0]))}return t}var a={},r={0:0},i=[];function o(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=a,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(n,a,function(e){return t[e]}.bind(null,a));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var c=window.webpackJsonp=window.webpackJsonp||[],l=c.push.bind(c);c.push=e,c=c.slice();for(var s=0;s<c.length;s++)e(c[s]);var d=l;i.push([48,1]),n()}({47:function(t,e,n){},48:function(t,e,n){"use strict";n.r(e);n(47);var a=n(0);var r=function(t){return t[0]},i=function(t){return t[1]};const o="#000",c="#333",l="#fff",s="#f00";let d={cat:"All"};const u=a.k("#loader"),p=a.k("#widget"),g=p.node().clientWidth,f=p.node().clientHeight,m=a.b("toggle","gaze:finder","dist:cat","dist:bin","dist:clear");m.on("toggle",(t,e)=>{!function(t,e){n(a.k("input[name='toggle']:checked").node().value);a.l("input[name='toggle']").on("change",(function(){a.c.preventDefault(),n(a.k("input[name='toggle']:checked").node().value)}));function n(n){console.log("toggstate",n),"gaze"===n?m.call("gaze:finder",null,t,e):m.call("dist:cat",null,t,e)}}(t,e)}),m.on("gaze:finder",(t,e)=>{console.log("destroyDistribution"),a.k("#dist").remove(),a.k("#filter .tab-menu").remove(),function(t,e){console.log("renderGaze");const n=p,r=a.k("#result").append("div").attr("id","gazeResult"),i=[-90,90],o=[-50,30],c=a.j().domain(i).range([0,g]),l=a.j().domain(o).range([f,0]),s=n.append("div").attr("id","gaze"),d=s.append("div").attr("id","img").append("img"),u=s.append("div").attr("id","cursor");function m(t,e,n,a,s,d){let u=function(t,e){var n=new Array(e),a=t.length,r=new Array(a);if(e>a)throw new RangeError("getRandom: more elements taken than available");for(;e--;){var i=Math.floor(Math.random()*a);n[e]=t[i in r?r[i]:i],r[i]=--a in r?r[a]:a}return n}(function(t,e,n,a){return function r(s=1){let d=a.filter(t=>t.yaw>e-s&&t.yaw<e+s&&t.pitch>n-s/2&&t.pitch<n+s/2);if(d.length>0){let e=s+1;return t.style("width",c(2*e-i[1])+"px").style("margin-left",c(e-i[1])/2*-1+"px").style("height",l(o[1]-2*e)+"px").style("margin-top",l(o[1]+e)/2+"px"),d}return r(s+1)}()}(e,n,a,s),1)[0],p=d.filter(t=>t.imageid===u.imageid)[0].imageobj;t.node().src=p.src,r.html(`<b>${u.object_title}</b>\n\t\t\t<br>${u.object_artist}\n\t\t\t<br>${u.object_century}\n\t\t\t<br>&nbsp;\n\t\t\t<br><i>${u.object_classification}</i>`)}m(d,u,0,0,t,e),n.on("mousemove",(function(){let n=a.i(this)[0],r=a.i(this)[1],i=Math.round(c.invert(n)),o=Math.round(l.invert(r));u.style("left",n+"px").style("top",r+"px"),m(d,u,i,o,t,e)})),function(t,e){const n=t.selectAll("svg").data([1]),a=n.enter().append("svg");n.merge(a).attr("viewBox",`0 0 ${g} ${f}`);const r=n.merge(a);r.append("line").attr("x1",c(-90)).attr("y1",l(0)).attr("x2",c(90)).attr("y2",l(0)).attr("stroke","red").attr("opacity",.5),r.append("line").attr("x1",c(0)).attr("y1",l(90)).attr("x2",c(0)).attr("y2",l(-90)).attr("stroke","red").attr("opacity",.5),r.selectAll("face").data(e).enter().append("circle").attr("r",1).attr("fill","white").attr("opacity",.5).attr("cx",t=>c(t.yaw)).attr("cy",t=>l(t.pitch))}(s,t)}(t,e)}),m.on("dist:cat",(t,e)=>{console.log("dist:cat",d.cat),console.log("destroyGaze"),a.k("#gaze").remove(),a.k("#gazeResult").remove(),function(t,e){console.log("renderDistribution");const n=function(t){const e=function(){var t,e,n,o=1,c=1,l=r,s=i;function d(t){var r={};return t.forEach((function(t,a){var i=s.call(p,t,a)/n,o=Math.trunc(i),c=l.call(p,t,a)/e,d=Math.trunc(c),u=d+"-"+o,p=r[u];p?p.push(t):((p=r[u]=[t]).i=d,p.j=o,p.x=d*e,p.y=o*n)})),a.m(r)}function u(t){return[t,t]}return d.x=function(t){return arguments.length?(l=t,d):l},d.y=function(t){return arguments.length?(s=t,d):s},d.square=function(e){return arguments.length<1&&(t=e),"m"+u(e).join("l")+"z"},d.size=function(t){return arguments.length?(o=+t[0],c=+t[1],d):[o,c]},d.side=function(a){return arguments.length?(e=t=+a,n=t,d):t},d.side(1)}().size([360,180]).side(18),n=t.map(t=>[t.yaw+180,t.pitch+90,t]);let o=e(n);return o.map(t=>(t.x=t.x-180,t.y=t.y-90,t))}("All"===d.cat?t:t.filter(t=>t.object_classification===d.cat)),u=g/2,b=p.selectAll("svg").data([1]),h=b.enter().append("svg").attr("id","dist");b.merge(h).attr("viewBox",`0 0 ${g} ${f}`);const v=b.merge(h),y=a.j().domain([0,a.h(n,t=>t.length)]).range([1,8]),j=a.f().scale(u).translate([g/2,f/2]).clipAngle(90),_=a.d(),k=a.g().projection(j),w=a.e().step([18,18]);v.append("circle").attr("cx",g/2).attr("cy",f/2).attr("r",u).attr("fill","black");v.append("path").datum(w).attr("class","graticule").attr("d",k).attr("fill","none").attr("stroke",c);const x=v.selectAll(".bin").data(n,t=>t.imageid),z=x.enter().append("g").attr("class","bin");z.append("path").attr("class","bin-target"),z.append("path").attr("class","bin-dot"),x.merge(z).attr("data-binid",(t,e)=>e).on("mouseover",(function(t){m.call("dist:bin",null,t,e),a.k(this).select(".bin-dot").attr("fill",s)})).on("mouseout",(function(t){m.call("dist:clear"),a.k(this).select(".bin-dot").attr("fill",l)})).on("click",(function(t){m.call("dist:bin",null,t,e)})),x.merge(z).select(".bin-target").attr("d",t=>k(_.center([t.x,t.y]).radius(y(a.h(n,t=>t.length)))())).attr("fill",o).attr("opacity",0),x.merge(z).select(".bin-dot").attr("d",t=>k(_.center([t.x,t.y]).radius(y(t.length))())).attr("fill",l),x.exit().remove()}(t,e),function(t,e){console.log("renderCategoryMenu");const n=a.k("#filter"),r=t.map(t=>t.object_classification).filter((t,e,n)=>n.indexOf(t)===e);r.unshift("All");const i=n.selectAll(".tab-menu").data([1]),o=i.enter().append("ul").attr("class","tab-menu");i.merge(o);const c=i.merge(o).selectAll(".tab").data(r),l=c.enter().append("li").attr("class","tab");c.merge(l).attr("data-link",t=>t).classed("active",t=>d.cat===t).text(t=>t).on("click",(function(){a.c.preventDefault();let n=a.k(this).attr("data-link");d.cat=n,m.call("dist:cat",null,t,e)}))}(t,e)}),m.on("dist:bin",(t,e)=>{!function(t,e){console.log("renderBinContents");const n=a.k("#result"),r=t.map(t=>t[2]),i=n.selectAll("#unpackedBin").data([1]),o=i.enter().append("div").attr("id","unpackedBin"),c=i.merge(o).selectAll(".face").data(r),l=c.enter().append("div").attr("class","face");l.append("img").attr("class","face-img"),l.append("p").attr("class","face-caption"),c.merge(l).attr("data-imgid",t=>t.imageid),c.merge(l).select(".face-img").attr("src",t=>e.filter(e=>e.imageid===t.imageid)[0].imageobj.src),c.merge(l).select(".face-caption").text(t=>t.imageid),c.exit().remove()}(t,e)}),m.on("dist:clear",()=>{console.log("destroyBinContents"),a.k("#unpackedBin").remove()});a.a("./public/data/temp_data.csv",(function(t){return{imageid:t.imageid,url:t.url,pitch:+t.pitch,yaw:+t.yaw,object_id:t.object_id,object_title:t.object_title,object_classification:t.object_classification,object_department:t.object_department,object_division:t.object_division,object_artist:t.object_artist,object_century:t.object_century,object_datebegin:t.object_datebegin,object_culture:t.object_culture,object_provenance:t.object_provenance,object_dimensions:t.object_dimensions,object_medium:t.object_medium,object_technique:t.object_technique,object_accessionyear:+t.object_accessionyear}})).then(t=>{(async function(t){const e=u.select(".progress_bar"),n=t.length;let a=0;const r=[],i=[];for(let o of t)r.push(new Promise(t=>{const r=new Image;r.onload=function(){a++,e.style("width",Math.round(a/n*100)+"%"),t()},r.src=`./public/img/${o}.jpg`,i.push({imageid:o,imageobj:r})}));return await Promise.all(r),u.remove(),i})(t.map(t=>t.imageid)).then(e=>{m.call("toggle",null,t,e),window.onresize=function(){a.k("#gaze").remove(),a.k("#dist").remove(),a.k("#gazeResult").remove(),m.call("toggle",null,t,e)}})})}});
//# sourceMappingURL=app.8cbe2cb6.js.map